<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>个人中心-翼升小程序</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="alternate icon" type="image/png" href="/home/assets/i/favicon.png">
    <link rel="stylesheet" href="/home/assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="/home/assets/css/common.css"/>
    <link rel="stylesheet" href="/home/assets/css/user.css"/>
    <link rel="stylesheet" href="/home/assets/css/pager.css"/>
</head>
<body style="width: 100%;">
<!-- header -->
<div id="myHeader"></div>
<!-- /header -->

<div class="hbanner">
    <div class="userbox tac">
        <img src="/home/assets/i/header.png" alt="" class="userHeader">
        <input type="file" class="changeHeaderImg" style="display: none;">
        <p class="uname nick-name"></p>
        <div class="hinfo">
            <span id="p_count" class="span1"></span>
            <span id="p_count1" class="span1"></span>
            <span class="span1" ><span id="ptype"></span> <button class="am-btn up-pay" id="sjbtn">体验更多新功能</button><button class="am-btn up-pay" id="xfbtn">续费</button></span>
            <span id="endtimee"></span>
        </div>
    </div>
    </div>
    <div class="article">

        <div class="am-container">
            <div data-am-widget="tabs" class="am-tabs am-tabs-d2">
                <ul class="am-tabs-nav am-cf">
                    <li class="am-active first-nav"><a href="[data-tab-panel-0]">我的小程序</a></li>
                    <li class=""><a href="[data-tab-panel-1]">详细资料</a></li>
                    <li class="deal_list"><a href="[data-tab-panel-2]">交易明细</a></li>
                    <li class=""><a href="[data-tab-panel-3]">账号安全</a></li>
                    <li class=""><a href="[data-tab-panel-4]">提交工单</a></li>
                    <li class="son_account"><a href="[data-tab-panel-5]">子账号</a></li>
                </ul>
                <div class="am-tabs-bd tablesus">
                    <div data-tab-panel-0 class="am-tab-panel am-active my_upro"> <!--我的小程序-->
                        <ul class="am-avg-sm-2 am-avg-md-4 am-avg-lg-5 am-thumbnails mypr">
                            <li id="add_new"><a href='#'>
                                <div class="li-con show-protocol"><img id="add_new_img" class="am-thumbnail" src="/home/assets/i/create.png"/>
                                    <p class="create-p"></p></div>
                            </a></li>
                        </ul>
                    </div>
                    <div data-tab-panel-1 class="am-tab-panel detailInfo"> <!--详细资料-->
                        <div class="am-g uinfo" id="uinfo">
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">姓名：</span>
                                <span id="uname" class="am-u-sm-8 nick-name"></span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">电话：</span>
                                <span id="mobile" class="am-u-sm-8"></span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">微信号：</span>
                                <span id="wechat" class="am-u-sm-8"></span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">QQ：</span>
                                <span id="qqid" class="am-u-sm-8"></span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">邮箱：</span>
                                <span id="email" class="am-u-sm-8"></span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-4 tar">公司名称：</span>
                                <span id="company" class="am-u-sm-8"></span>
                            </div>
                            <div class="am-u-sm-12 tac">
                                <button class="am-btn am-btn-default" id="changeIfo">修改资料</button>
                            </div>
                        </div>
                        <div class="change am-g" id="changeBox" style="display:none;">
                            <form class="am-form am-form-horizontal">
                                <div class="am-form-group am-u-md-4 am-u-sm-12 mar-top">
                                    <label for="input_name" class="am-u-sm-4 am-form-label">姓名：</label>
                                    <div class="am-u-sm-8">
                                        <input type="text" id="input_name" placeholder="">
                                    </div>
                                </div>
                                <div class="am-form-group am-u-md-4 am-u-sm-12 mar-top">
                                    <label for="input_wechat" class="am-u-sm-4 am-form-label">微信号：</label>
                                    <div class="am-u-sm-8">
                                        <input type="text" id="input_wechat" placeholder="">
                                    </div>
                                </div>
                                <div class="am-form-group am-u-md-4 am-u-sm-12 mar-top">
                                    <label for="input_qq" class="am-u-sm-4 am-form-label">QQ：</label>
                                    <div class="am-u-sm-8">
                                        <input type="text" id="input_qq" placeholder="">
                                    </div>
                                </div>
                                <div class="am-form-group am-u-md-4 am-u-sm-12 mar-top">
                                    <label for="input_company" class="am-u-sm-4 am-form-label">公司名称：</label>
                                    <div class="am-u-sm-8">
                                        <div class="am-u-sm-8">
                                            <input type="text" id="input_company" placeholder="">
                                        </div>
                                        <!--<span id="input_company"></span>-->
                                        <!--<span class="changeCompany">修改</span>-->
                                    </div>
                                </div>
                            </form>
                            <div class="am-u-sm-12 tac">
                                <button class="am-btn am-btn-default btn-save" id="saveChange">保存</button>
                                <button class="am-btn am-btn-default" id="cancelChange">取消</button>
                            </div>
                        </div>
                    </div>
                    <div data-tab-panel-2 class="am-tab-panel udeal_detail">  <!--交易明细-->
                        <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped">
                            <thead>
                            <tr class="dealTable">
                                <th class="order_table_deal2">订单号</th>
                                <th class="order_table_deal1">版本类型</th>
                                <th class="order_table_deal2">版本年限</th>
                                <th class="order_table_deal1">交易金额</th>
                                <th class="order_table_deal1">支付方式</th>
                                <th class="order_table_deal1">交易状态</th>
                                <th class="order_table_deal2">交易日期</th>
                            </tr>
                            </thead>
                            <tbody id="deal_list"></tbody>
                        </table>
                        <ul class="am-pagination" id="order_ul">
                        </ul>
                    </div>
                    <div data-tab-panel-3 class="am-tab-panel "> <!--账号安全-->
                        <div class="am-g">
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-8 tar">安全指数：</span>
                                <span class="am-u-sm-4 chan" id="changePWD">修改密码</span></div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-8 tar saveemail"></span>
                                <span class="am-u-sm-4 chan" id="changeemail">&nbsp;&nbsp;绑定邮箱</span>
                            </div>
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-8 tar savemobile"></span>
                                <span class="am-u-sm-4 chan" id="changephone">&nbsp;&nbsp;修改手机</span>
                            </div>
                        </div>
                        <div class="am-g">&nbsp;</div>
                        <div class="am-g">
                            <div class="am-u-sm-12 am-u-md-4">
                                <span class="am-u-sm-8 tar">密保设定：<i class="pwd-status">未设置</i></span>
                                <span class="am-u-sm-4 chan" id="changepwdPro">&nbsp;&nbsp;<span class="pwd-handel">设置密保</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div data-tab-panel-4 class="am-tab-panel work-order">  <!--提交工单-->
                        <div data-am-widget="tabs" class="am-tabs am-tabs-default" id="order_list">
                            <!--order_list-->
                            <ul class="am-tabs-nav am-cf">
                                <li class="am-active order_all"><a href="[data-tab-panel-b0]">全部</a></li>
                                <li class="wait_reply"><a href="[data-tab-panel-b2]">待处理</a></li>
                                <li class="on_handle"><a href="[data-tab-panel-b1]">处理中</a></li>
                                <li class="order_done"><a href="[data-tab-panel-b3]">已结单</a></li>
                                <li class="subNew">
                                    <button id="sub_new_order">提交新工单</button>
                                </li>
                            </ul>
                            <div class="choose_box">
                                <div class="am-form-group">
                                    <div class="selectContainer1">
                                        <select id="doc-select-1">
                                            <option value="1" style="display: none;">请选择</option>
                                            <option value="number">工单编号</option>
                                            <option value="title">工单标题</option>
                                            <option value="describe">问题描述</option>
                                        </select>
                                        <span class="am-form-caret"></span>
                                        <img class="closeImg1" src="../assets/caseImg/close.svg" alt="" >
                                    </div>
                                </div>
                                <div class="am-topbar-form am-topbar-left am-form-inline" role="search">
                                    <div class="am-form-group">
                                        <input type="text" class="am-form-field am-input-sm" id='work_order_kw' placeholder="输入关键字">
                                        <!--<button class="search_wo_btn"><img src="/home/assets/i/search.png" alt=""></button>-->
                                    </div>
                                </div>
                                <div class="am-form-group question-type">
                                    <div class="selectContainer2">
                                        <label id="label2">问题类型:</label>
                                        <select id="doc-select-2">
                                            <option value="5" style="display: none;">请选择</option>
                                            <option value="2">技术类</option>
                                            <option value="1">财务类</option>
                                            <option value="3">运营类</option>
                                            <option value="0">其他类型</option>
                                        </select>
                                        <span class="am-form-caret"></span>
                                        <img class="closeImg2" src="../assets/caseImg/close.svg" alt="" >
                                    </div>
                                </div>

                                <div class="am-input-group am-datepicker-date am-datepicker-date1"
                                     data-am-datepicker="{format: 'yyyy-mm-dd'}">
                                    <span class="data_title">选择日期：</span>
                                    <input type="text" class="am-form-field" id="picker_date" placeholder="选择日期" data-am-datepicker readonly required />
                                    <!--<span class="am-input-group-btn am-datepicker-add-on">-->
                                    <!--<button class="am-btn am-btn-default" type="button">-->
                                    <!--<span class="am-icon-calendar"></span>-->
                                    <!--</button>-->
                                    <!--</span>-->
                                    <span class="cancelDate cancelDate1"></span>
                                </div>
                                <span class="search_wo_btn">搜索</span>
                            </div>
                            <div class="am-tabs-bd am_tabs_order">
                                <div data-tab-panel-b0 class="am-tab-panel am-active">

                                    <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped" >
                                        <thead>
                                        <tr>
                                            <th width="170">工单编号</th>
                                            <th width="150">创建时间</th>
                                            <th width="150">工单标题</th>
                                            <th width="80">问题类型</th>
                                            <th width="300">问题描述</th>
                                            <th width="80">处理状态</th>
                                            <th width="120">操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="order_all">  </tbody>
                                    </table>
                                </div>
                                <div data-tab-panel-b1 class="am-tab-panel ">

                                    <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped">
                                        <thead>
                                        <tr>
                                            <th class="order_table_1">工单编号</th>
                                            <th class="order_table_1">创建时间</th>
                                            <th class="order_table_1">工单标题</th>
                                            <th class="order_table_1">问题类型</th>
                                            <th class="order_table_2">问题描述</th>
                                            <th class="order_table_1">处理状态</th>
                                            <th class="order_table_1">操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="wait_reply">

                                        </tbody>
                                    </table>
                                </div>
                                <div data-tab-panel-b2 class="am-tab-panel ">
                                    <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped">
                                        <thead>
                                        <tr>
                                            <th class="order_table_1">工单编号</th>
                                            <th class="order_table_1">创建时间</th>
                                            <th class="order_table_1">工单标题</th>
                                            <th class="order_table_1">问题类型</th>
                                            <th class="order_table_2">问题描述</th>
                                            <th class="order_table_1">处理状态</th>
                                            <th class="order_table_1">操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="on_handle">

                                        </tbody>
                                    </table>
                                </div>

                                <div data-tab-panel-b3 class="am-tab-panel ">
                                    <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped">
                                        <thead>
                                        <tr>
                                            <th class="order_table_1">工单编号</th>
                                            <th class="order_table_1">创建时间</th>
                                            <th class="order_table_1">工单标题</th>
                                            <th class="order_table_1">问题类型</th>
                                            <th class="order_table_2">问题描述</th>
                                            <th class="order_table_1">处理状态</th>
                                            <th class="order_table_1">操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="order_done">

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div id="sub_work_order">
                            <div class="title">
                                1.选择咨询业务
                            </div>
                            <div class="type1">
                                <ul class="clearfloat type1box">
                                    <li class="item img1 choose_type_of_q" data-type="技术类">
                                        <img src="/home/assets/i/q1.png" alt="" >
                                    </li>
                                    <li class="item choose_type_of_q" data-type="运营类">
                                        <img src="/home/assets/i/q2.png" alt="" >
                                    </li>
                                    <li class="item img1 choose_type_of_q" data-type="财务类">
                                        <img src="/home/assets/i/q3.png" alt="" >
                                    </li>
                                    <li class="item choose_type_of_q" data-type="其他问题">
                                        <img src="/home/assets/i/q4.png" alt="" >
                                    </li>
                                </ul>
                            </div>
                            <div class="title">
                                2.选择问题类型
                            </div>
                            <div class="type2 clearfloat">
                                <ul class="type2_choose_box">
                                    <li class="item choose_type2_of_q">
                                        分割线组件
                                    </li>
                                    <li class="item choose_type2_of_q">
                                        分类列表组件
                                    </li>
                                    <li class="item choose_type2_of_q">
                                        分销系统组件
                                    </li>
                                    <li class="item choose_type2_of_q">
                                        购物车组件
                                    </li>
                                </ul>
                                <div class="type2_note">
                                    <h3>为您推荐解决率最高的热门知识点，可能有您需要的答案：</h3>
                                    <ol id="hotanswer">
                                        <li class="item hot_answer_of_q"><a target="_blank" href="/home/help/doc.html?id=3">如何使用分割线组件？</a></li>
                                        <li class="item hot_answer_of_q"><a target="_blank" href="/home/help/doc.html?id=3">分割线类型在哪里选择?</a></li>
                                        <li class="item hot_answer_of_q"><a target="_blank" href="/home/help/doc.html?id=3">如何设置分割线的颜色、高度等？</a></li>
                                    </ol>
                                </div>
                            </div>
                            <div class="title">
                                3.新建工单
                            </div>
                            <form  id="order_sub"  target="hidden_frame">
                                <fieldset>
                                    <div class="sub_order_box">
                                        <div class="sub_order_title"><span class="red">*</span>问题类型：<span id="now_type1"></span> > <span id="now_type2"></span></div>
                                        <div class="order_title"><span class="red">*</span>工单标题：<input type="text" id="new_worder_title"> </div>
                                        <div class="question_des"><span class="red">*</span>问题描述：<textarea class="fade_back_text" name="txt" clos="100" rows="6" warp="virtual" id="new_worder_des"></textarea></div>
                                        <div class="fade_back">
                                            <div class="am-form-group am-form-file">
                                                <label for="doc-form-file">上传附件：</label>
                                                <button type="button" class="am-btn am-btn-danger am-btn-sm" id="btn111">
                                                    <i class="am-icon-cloud-upload"></i> 上传附件</button>
                                                <span class="des">最多上传5张图片，附件大小不得超过2M。附件支持的格式有'jpg','jpeg','bmp','png','gif','text','rar','zip','doc','docx','pdf'</span>
                                                <input id="doc-form-file" multiple type="file">
                                            </div>
                                            <div id="file-list"></div>
                                        </div>
                                    </div>
                                    <div class="file_sub">
                                        <input type="button" class="sub_cancel" value="取消" id="cancel_new_order">
                                        <button class="sub_sub" type="submit">确定</button>
                                    </div>
                                </fieldset>
                            </form>
                            <iframe name='hidden_frame' id="hidden_frame" style="display:none"></iframe>
                        </div>
                        <div id="order_detail"> <!--order_detail-->
                            <div class="states">
                                <div class="statesbox">
                                    <div class="circle">
                                        <span class="tick"></span>
                                    </div>
                                    <p class="statestext">待处理</p>
                                </div>
                                ·····································
                                <div class="statesbox">
                                    <div class="circle">
                                        <span class="tick"></span>
                                    </div>
                                    <p class="statestext">处理中</p>
                                </div>
                                ·····································
                                <div class="statesbox">
                                    <div class="circle">
                                        <span class="tick"></span>
                                    </div>
                                    <p class="statestext">等待回复</p>
                                </div>
                                ·····································
                                <div class="statesbox">
                                    <div class="circle">
                                        <span class="tick"></span>
                                    </div>
                                    <p class="statestext">已结单</p>
                                </div>
                            </div>
                            <div class="detail">
                                <div class="am-g">
                                    <div class="am-u-sm-4">
                                        工单编号：<span id="worder_num"></span>
                                    </div>
                                    <div class="am-u-sm-5">
                                        创建时间：<span id="wodetail_time"></span>
                                    </div>
                                    <div class="am-u-sm-3 tac">
                                        工单标题：<span id="wodetail_title"></span>
                                    </div>

                                </div>

                                <div class="am-g">
                                    <div class="am-u-sm-4">
                                        问题类型：<span id="wodetail_type"></span>
                                    </div>
                                    <div class="am-u-sm-5">
                                        处理状态：<span id="wodetail_status"></span>
                                    </div>
                                    <div class="am-u-sm-3">

                                    </div>
                                </div>
                                <div class="am-g">
                                    <div class="am-u-sm-12">
                                        问题描述：<span id="wodetail_des"></span>
                                    </div>
                                </div>

                            </div>
                            <div >
                                <img src="/home/assets/i/commitor.png"  class="committag" alt="">

                            </div>
                            <div class="content" id="wodetail_con">

                            </div>
                            <div >
                                <img src="/home/assets/i/record.png"  class="committag" alt="">
                            </div>
                            <form class="sub_order_form" id="wodetail_sub" target="hid_frame">
                                <fieldset>
                                    <div class="fade_back">
                                        反馈留言：<textarea class="fade_back_text" id="fade_back_t" ame="txt" clos="100" rows="5" warp="virtual"></textarea>
                                    </div>
                                    <div class="fade_back">
                                        <div class="am-form-group am-form-file">
                                            <label for="doc-form-file1">上传附件：</label>
                                            <button type="button" class="am-btn am-btn-danger am-btn-sm" id="btn222">
                                                <i class="am-icon-cloud-upload"></i> 上传附件</button>
                                            <span class="des">最多上传5张图片，附件大小不得超过2M。附件支持的格式有'jpg','jpeg','bmp','png','gif','text','rar','zip','doc','docx','pdf'</span>

                                            <input id="doc-form-file1" multiple type="file">
                                        </div>
                                        <div id="file-list1"></div>
                                    </div>

                                    <div class="file_sub">
                                        <input type="button" class="sub_cancel" value="返回" id="return_order">
                                        <button  class="sub_sub" type="submit" id="sub_fade_back"> 确定</button>
                                    </div>
                                </fieldset>
                            </form>
                            <iframe name='hid_frame' id="hid_frame" style="display:none"></iframe>
                        </div>
                </div>
                    <div data-tab-panel-5 class="am-tab-panel sonAccount">
                        <div class="son_account_index">
                            <div class="top-menu am-g-fixed">
                                <div>子账号数量：<span class="sonAccountNum"></span></div>
                                <div class="top-menu-right">
                                    <p class="button-p handelRecord">操作记录</p>
                                    <p class="button-p settingSuffix">设置账号后缀</p>
                                    <p class="button-p buildSon">新建子账号</p>
                                </div>
                            </div>
                            <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped" style="margin-top: 0">
                                <thead>
                                <tr>
                                    <th width="170">登录账号</th>
                                    <th width="150">姓名</th>
                                    <th width="150">权限</th>
                                    <th width="300">操作记录</th>
                                    <th width="">操作</th>
                                </tr>
                                </thead>
                                <tbody id="order_son_account"></tbody>
                            </table>
                            <ul class="am-pagination" id="order_son_account_pagination">
                            </ul>
                        </div>
                        <div class="fill_info">
                            <p class="sun_account_fill_info">子账号）新建子账号</p>
                            <!--<form action="" class="am-form">-->
                                <!--<fieldset>-->
                                    <div class="am-form-group-1">
                                        <label class="fill_info_title">登录账号：</label>
                                        <input type="text" id="son_mobile" class="son_input" maxlength="11" placeholder="输入账号"/>
                                        <span class="fill_info_suffix">&nbsp;&nbsp;<i style="line-height: 32px" id="i_suffix"></i></span>
                                        <span class="fill_info_tip"></span>
                                    </div>
                                    <div class="am-form-group-1">
                                        <label class="fill_info_title">登录密码：</label>
                                        <input type="password" id="son_pwd1" class="son_input" onblur="pwd1Check()" maxlength="16" placeholder="输入密码"/>
                                        <span class="fill_info_tip"></span>
                                    </div>
                                    <div class="am-form-group-1">
                                        <label class="fill_info_title">确认密码：</label>
                                        <input type="password" id="son_pwd2" onblur="pwd2Check()" class="son_input" maxlength="16" placeholder="输入密码"/>
                                        <span class="fill_info_tip"></span>
                                    </div>
                                    <div class="am-form-group-1">
                                        <label class="fill_info_title">姓名：</label>
                                        <input type="text" id="son_name" class="son_input" placeholder="输入姓名"/>
                                    </div>
                                    <div style="padding-left: 150px">
                                        <button class="am-btn son-btn-cancel">取消</button>
                                        <button id="son_save_fill_info" class="am-btn son-btn-save" style="margin-left: 20px">保存</button>
                                    </div>
                                <!--</fieldset>-->
                            <!--</form>-->
                        </div>
                        <div class="edit_info">
                            <p class="sun_account_fill_info">子账号）编辑子账号</p>
                            <p style="display: none" id="account_id"></p>
                            <div class="am-form-group-1">
                                <label class="fill_info_title">登录账号：</label>
                                <input type="text" id="son_edit_account" class="son_input" placeholder=""/>
                                <span class="fill_info_suffix">&nbsp;&nbsp;<i style="line-height: 32px" class="i_suffix"></i></span>
                            </div>
                            <div class="am-form-group-1">
                                <label class="fill_info_title">姓名：</label>
                                <input type="text" id="son_edit_name" class="son_input" placeholder=""/>
                            </div>
                            <div style="padding-left: 150px">
                                <button class="am-btn son-btn-cancel">取消</button>
                                <button id="son_save_edit_account" class="am-btn son-btn-save" style="margin-left: 20px">保存</button>
                            </div>
                        </div>
                        <div class="handel_record" style="text-align: center">
                            <p class="sun_account_fill_info" style="text-align: left">子账号）操作记录</p>
                            <div class="am-g flex_row">
                                <span class="record_label">姓名:&nbsp;&nbsp;</span>
                                <input type="text" id="search_name" class="" placeholder="请输入关键词">
                                <div class="am-input-group am-datepicker-date am-datepicker-date2"
                                     style="margin-left: 100px"
                                     data-am-datepicker="{format: 'yyyy-mm-dd'}">
                                    <span class="data_title">选择日期：</span>
                                    <input type="text" class="am-form-field" id="picker_date2" placeholder="开始时间" data-am-datepicker readonly required />
                                    <!--<span class="cancelDate cancelDate2"></span>-->
                                </div>&nbsp;-
                                <div class="am-input-group am-datepicker-date am-datepicker-date3"
                                     style="margin-left: 5px"
                                     data-am-datepicker="{format: 'yyyy-mm-dd'}">
                                    <input type="text" class="am-form-field" id="picker_date3" placeholder="结束时间" data-am-datepicker readonly required />
                                    <!--<span class="cancelDate cancelDate3"></span>-->
                                </div>
                                <span class="search_wo_btn" id="search_record">搜索</span>
                            </div>
                            <table class="am-table am-tableo am-table-bordered am-table-radius am-table-striped" style="margin-top: 0">
                                <thead>
                                <tr>
                                    <th width="170">姓名</th>
                                    <th width="170">小程序</th>
                                    <th width="170">日期</th>
                                    <th width="" class="td_left">记录</th>
                                </tr>
                                </thead>
                                <!--<tbody id="order_son_handel_record"></tbody>-->
                                <tbody id="wraper" class="pagerHtmlWrap"></tbody>
                            </table>
                            <div id="pager2" class="pager clearfix"></div>

                            <!--<ul class="am-pagination" id="order_son_handel_record_pagination">-->
                            <!--</ul>-->
                        </div>
                        <div class="authorize">
                            <p class="sun_account_fill_info">子账号)授权</p>
                            <div class="mps_list"></div>
                            <div class="more_store" style="display: none;">
                                <!--<span>连锁多商家:</span>-->
                                <!--<label><input type="radio" name="more_store" value="1">总店</label>-->
                                <!--<label><input type="radio" name="more_store" value="2">1分店</label>-->
                                <!--<label><input type="radio" name="more_store" value="3">2分店</label>-->
                            </div>
                            <div class="mps_permission_list">
                                <p style="display: block;" class="hideall">
                                    <span>全部</span>
                                    <label><input type="checkbox" name="all" onclick="changeAll.call(this)">全部</label>
                                </p>
                                <p class="display_none" id="statistics">
                                    <span>数据统计:</span>
                                    <label ><input type="checkbox" name="statistics" value="statistics_data_screening">数据总览</label>
                                    <label ><input type="checkbox" name="statistics" value="statistics_visitors_analysis">访客分析</label>
                                    <!--<label class="display_none"><input type="checkbox" name="statistics" value="">用户分析</label>-->
                                    <label ><input type="checkbox" name="statistics" value="statistics_data_analysis">数据分析</label>
                                    <label ><input type="checkbox" name="statistics" value="statistics_user_portrait">用户画像</label>
                                </p>
                                <p class="display_none" id="customer">
                                    <span>用户管理:</span>
                                    <label ><input type="checkbox" name="customer" value="customer_list">用户列表</label>
                                    <label ><input type="checkbox" name="customer" value="customer_group">用户分组</label>
                                </p>
                                <p class="display_none" id="product">
                                    <span>商品管理:</span>
                                    <label ><input type="checkbox" name="product" value="product_list">商品列表</label>
                                    <label ><input type="checkbox" name="product" value="product_sorting_setting">排序设置</label>
                                    <label ><input type="checkbox" name="product" value="product_classify_manage">分类管理</label>
                                    <label ><input type="checkbox" name="product" value="product_integral_goods">积分商品</label>
                                </p>
                                <p class="display_none" id="marketing_tool">
                                    <span>营销工具:</span>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_coupon">优惠券</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_vip_card">会员卡</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_group_booking">拼团</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_seckill">秒杀</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_slyder_adventures">大转盘</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_smash_golden_eggs">砸金蛋</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_dmf">当面付</label>
                                    <label class="display_none"><input type="checkbox" name="marketing_tool" value="marketing_tool_czk">储值卡</label>
                                </p>
                                <p class="display_none" id="comment">
                                    <span>评论管理:</span>
                                    <label><input type="checkbox" name="comment" value="comment_list">评论管理</label>
                                </p>
                                <p class="display_none" id="order">
                                    <span>订单管理:</span>
                                    <label><input type="checkbox" name="order" value="order_list">订单列表</label>
                                    <label><input type="checkbox" name="order" value="order_billing_details">账单明细</label>
                                    <label><input type="checkbox" name="order" value="order_return">退换货</label>
                                </p>
                                <p class="display_none" id="slider">
                                    <span>轮播管理:</span>
                                    <label><input type="checkbox" name="slider" value="slider_list"></label>
                                </p>
                                <p class="display_none" id="applet_message">
                                    <span>消息管理:</span>
                                    <label ><input type="checkbox" name="applet_message" value="applet_message_list">消息管理</label>
                                </p>
                                <p class="display_none" id="article">
                                    <span>文章管理:</span>
                                    <label ><input type="checkbox" name="article" value="article_list">文章列表</label>
                                    <label ><input type="checkbox" name="article" value="article_group">文章分类</label>
                                </p>
                                <p class="display_none" id="goods_video">
                                    <span>视频管理:</span>
                                    <label ><input type="checkbox" name="goods_video" value="goods_video_list">视频列表</label>
                                    <label ><input type="checkbox" name="goods_video" value="goods_video_group">视频分类</label>
                                </p>
                                <p class="display_none" id="video_demo">
                                    <span>展示视频:</span>
                                    <label><input type="checkbox" name="video_demo" value="video_demo_list">视频列表</label>
                                    <label><input type="checkbox" name="video_demo" value="video_demo_group">视频分类</label>
                                </p>
                                <p class="display_none" id="layout">
                                    <span>页面管理:</span>
                                    <label ><input type="checkbox" name="layout" value="layout_list">页面管理</label>
                                </p>
                                <p class="display_none" id="map">
                                    <span>设置地图:</span>
                                    <label ><input type="checkbox" name="map" value="map_map">设置地图</label>
                                </p>
                                <p class="display_none" id="form">
                                    <span>表单管理:</span>
                                    <label ><input type="checkbox" name="form" value="form_list">表单管理</label>
                                </p>
                                <p class="display_none" id="distributor">
                                    <span>微分销:</span>
                                    <label><input type="checkbox" name="distributor" value="distributor_list">分销商列表</label>
                                    <label><input type="checkbox" name="distributor" value="distributor_commission_set_up">佣金设置</label>
                                    <label><input type="checkbox" name="distributor" value="distributor_apply_withdrawal">申请提现</label>
                                    <label><input type="checkbox" name="distributor" value="distributor_commission_statistics">佣金统计</label>
                                    <label><input type="checkbox" name="distributor" value="distributor_withdraw_setting">分销设置</label>
                                </p>
                                <p class="display_none" id="floating">
                                    <span>悬浮窗列表:</span>
                                    <label ><input type="checkbox" name="form" value="floating_list">悬浮窗列表</label>
                                </p>
                                <p class="display_none" id="meal">
                                    <span>点餐管理:</span>
                                    <label ><input type="checkbox" name="form" value="meal_shop">点餐管理</label>
                                </p>
                                <p class="display_none" id="image_list">
                                    <span>图片列表:</span>
                                    <label ><input type="checkbox" name="form" value="image_list_list">图片列表</label>
                                </p>
                                <p>
                                    <button class="am-btn son-btn-cancel ">取消</button>
                                    <button id="mps_permission_save" class="am-btn son-btn-save" style="margin-left: 20px">保存</button>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="am-modal am-modal-prompt" tabindex="-1" id="my-cpwd">
                <div class="am-modal-dialog">
                    <div class="am-modal-hd">修改密码</div>
                    <div class="am-modal-bd am-g clearfloat">
                        <div class="clearfloat"><span class="am-u-sm-4">当前密码:</span><input type="password"
                                                                                           class="am-modal-prompt-input am-u-sm-8 pwdNum">
                        </div>
                        <div class="clearfloat">
                            <span class="am-u-sm-4">新密码:</span>
                            <input type="password" class="am-modal-prompt-input am-u-sm-8 pwdNum" id="pwd1">
                        </div>
                        <p class="pwdTip"></p>
                        <!--*请输入长度8-20且必须包含大小写字母和数字的字符-->
                        <div class="clearfloat">
                            <span class="am-u-sm-4">确认密码:</span>
                            <input type="password" class="am-modal-prompt-input am-u-sm-8 pwdNum" id="pwd2">
                        </div>
                        <p class="pwdTip1"></p>
                    </div>
                    <div class="am-modal-footer">
                        <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                        <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                    </div>
                </div>
        </div>

        <div class="am-modal am-modal-prompt" tabindex="-1" id="my-cemail">
            <div class="am-modal-dialog ">
                <div class="am-modal-hd">绑定邮箱</div>
                <div class="am-modal-bd am-g clearfloat">
                    <div class="clearfloat"><span class="am-u-sm-4">常用邮箱：</span> <input type="text" id="bind-email-in"
                                                                                        class="am-modal-prompt-input am-u-sm-8">
                    </div>
                    <!--<div class="clearfloat"><span class="am-u-sm-4">验证码：</span><input type="text"-->
                                                                                      <!--class="am-modal-prompt-input am-u-sm-3">-->
                        <!--<button> 获取验证码</button>-->
                    <!--</div>-->
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>

        <div class="am-modal am-modal-prompt" tabindex="-1" id="my-cphone">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">修改手机</div>
                <div class="am-modal-bd">
                    <!--<div class="clearfloat"><span class="am-u-sm-4">手机号码：</span><input type="text"-->
                                                                                       <!--class="am-modal-prompt-input am-u-sm-8 oldPhone">-->
                    <!--</div>-->
                    <!--<div class="clearfloat"><span class="am-u-sm-4">验证码：</span><input type="text"-->
                                                                                      <!--class="am-modal-prompt-input am-u-sm-3">-->
                        <!--<button class="am-u-sm-4 getOldCode"> 获取验证码</button>-->
                    <!--</div>-->
                    <!--<p class="worning">提示：绑定新手机需要验证当前手机</p>-->
                    <div class="clearfloat"><span class="am-u-sm-4">新手机号码：</span><input type="text"
                                                                                        class="am-modal-prompt-input am-u-sm-8 newPhone">
                    </div>
                    <div class="clearfloat"><span class="am-u-sm-4">验证码：</span><input type="text"
                                                                                      class="am-modal-prompt-input am-u-sm-3">
                        <button class="am-u-sm-4 getNewCode"> 获取验证码</button>
                    </div>
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>
          <!--创建小程序-->
        <div class="am-modal am-modal-prompt" tabindex="-1" id="my-cprogram">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">新建小程序</div>
                <div class="am-modal-bd">
                    <div class="clearfloat"><span class="am-u-sm-4">小程序名称：</span>
                        <input type="text" class="am-modal-prompt-input am-u-sm-8 mpName" maxlength ='15'>
                        <div class="tac tor">小程序名称最多15个汉字</div>
                    </div>
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>

        <!--密保设置-->
        <div class="mask-protocol-pwdpro am-modal am-modal-prompt" tabindex="-1" id="my-pwdpro">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">设置密保问题</div>
                <div class="am-modal-bd am-g clearfloat">
                    <div class="clearfloat chan1">
                        <span class="am-u-sm-4">问题1:</span>
                        <select class="settingPwdproSelect1 am-modal-prompt-input1 am-u-sm-8">
                            <option value="0" style="display: none"></option>
                        </select>
                        <input class="customInput settingPwdproSelect3 am-modal-prompt-input am-u-sm-8" type="text" style="display: none" placeholder="请输入自定义问题">
                    </div>
                    <div class="clearfloat">
                        <span class="am-u-sm-4">答案：</span>
                        <input class="settingPwdproSelect1Input am-modal-prompt-input am-u-sm-8" type="text">
                    </div>
                    <div class="clearfloat chan1">
                        <span class="am-u-sm-4">问题2:</span>
                        <select class="settingPwdproSelect2 am-modal-prompt-input1 am-u-sm-8">
                            <option value="0" style="display: none"></option>
                        </select>
                        <input class="customInput settingPwdproSelect3 am-modal-prompt-input am-u-sm-8" type="text" style="display: none" placeholder="请输入自定义问题">
                    </div>
                    <div class="clearfloat">
                        <span class="am-u-sm-4">答案：</span>
                        <input class="settingPwdproSelect2Input am-modal-prompt-input am-u-sm-8" type="text">
                    </div>
                    <div class="clearfloat chan1">
                        <span class="am-u-sm-4">问题3:</span>
                        <select class="settingPwdproSelect3 am-modal-prompt-input1 am-u-sm-8">
                            <option value="0" style="display: none"></option>
                        </select>
                        <input class="customInput settingPwdproSelect3 am-modal-prompt-input am-u-sm-8" type="text" style="display: none" placeholder="请输入自定义问题">
                    </div>
                    <div class="clearfloat">
                        <span class="am-u-sm-4">答案：</span>
                        <input class="settingPwdproSelect3Input am-modal-prompt-input am-u-sm-8" type="text">
                    </div>
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn pwdpro-mask-cancel" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn pwdpro-mask-ok" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>
        <!--密保设置-->

        <!--修改密保-->
        <div class="mask-protocol-pwdproChange am-modal am-modal-prompt" tabindex="-1" id="my-pwdproChange">
        <div class="am-modal-dialog">
            <div class="am-modal-hd">修改密保问题--验证密保</div>
            <div class="am-modal-bd am-g clearfloat">
                <div class="clearfloat chan2">
                    <span class="am-u-sm-4">问题1：</span>
                    <select class="PwdproChangeSelect1 am-modal-prompt-input1 am-u-sm-8">
                        <option value="0" style="display: none"></option>
                    </select>
                </div>
                <div class="clearfloat">
                    <span class="am-u-sm-4">答案：</span>
                    <input type="text" class="am-modal-prompt-input am-u-sm-8 PwdproChangeSelect1Input">
                </div>
                <div class="clearfloat chan2">
                    <span class="am-u-sm-4">问题2：</span>
                    <select class="PwdproChangeSelect2 am-modal-prompt-input1 am-u-sm-8">
                        <option value="0" style="display: none"></option>
                    </select>
                </div>
                <div class="clearfloat">
                    <span class="am-u-sm-4">答案：</span>
                    <input type="text" class="am-modal-prompt-input am-u-sm-8 PwdproChangeSelect2Input">
                </div>
            </div>
            <div class="am-modal-footer">
                <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                <span class="am-modal-btn" data-am-modal-confirm>确定</span>
            </div>
        </div>
    </div>
        <!--修改密保-->

        <div class="am-modal am-modal-prompt" tabindex="-1" id="bind_wx">
            <div class="am-modal-dialog">
                <img class="close_wx_bind" src="../assets/caseImg/close.svg" alt="">
                <p class="bind_wx_text">请使用微信‘扫一扫’</p>
                <div class="bind_wx_div" id="wechat_code">
                </div>
            </div>
        </div>
        <div class="am-modal am-modal-prompt" tabindex="-1" id="son_reset_pwd">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">重置密码</div>
                <div class="am-modal-bd am-g clearfloat">
                    <div class="clearfloat">
                        <span class="am-u-sm-4">设置密码:</span>
                        <input type="password" class="am-modal-prompt-input am-u-sm-8" id="son_reset_pwd1">
                    </div>
                    <p class="son_pwdTip"></p>
                    <!--*请输入长度8-20且必须包含大小写字母和数字的字符-->
                    <div class="clearfloat">
                        <span class="am-u-sm-4">确认密码:</span>
                        <input type="password" class="am-modal-prompt-input am-u-sm-8" id="son_reset_pwd2">
                    </div>
                    <p class="son_pwdTip1"></p>
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>
        <!--提示，确认-->
        <div class="am-modal am-modal-prompt" tabindex="-1" id="use_unUse">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">提示</div>
                <p class="use_unUse_text am-modal-bd am-g clearfloat"></p>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>
        <div class="am-modal am-modal-prompt" tabindex="-1" id="my_set_suffix">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">设置账号后缀</div>
                <div class="am-modal-bd am-g clearfloat">
                    <p class="am-g">
                    <span class="am-u-sm-4">账号后缀:</span>
                    <input type="text" class="am-modal-prompt-input am-u-sm-8" id="suffix">
                    </p>
                    <p class="suffix_tip">请设置以@开头且只能包含数字、字母的4-10位字符</p>
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                    <span class="am-modal-btn" data-am-modal-confirm>提交</span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="guide-userCenter" style="display: none">
    <div class="guide-con">
        <img src="/home/assets/i/create.png" class="guide-img">
        <img src="../assets/caseImg/step/step3.png" class="step3-img">
    </div>
    <img src="../assets/caseImg/step/jump.png" class="jump-img">
</div>
<!-- footer -->
<div id="myFooter"></div>
<!-- /footer -->
<script src="/home/assets/js/jquery.min.js"></script>
<script src="/home/assets/js/jquery.lazyload.min.js"></script>
<script src="../assets/js/jquery.z-pager.js"></script>
<!--[if lt IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/amazeui/2.7.2/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/amazeui/2.7.2/js/amazeui.min.js"></script>
<script src="/home/assets/js/footer.js"></script>
<script src="https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>
<script>

    $(function () {
        //新手引导
        $.ajax({
            url:'/home/User/queryStatus',
            type: 'post',
            success:function (res) {
                if(res.status === 200){
                    if(res.data.personal_status == 0){
                        $('.guide-userCenter').show()
                        $('body').css('position', 'fixed')
                        $('.guide-con').css('top', $('#add_new_img').offset().top + 38)
                        $('.guide-con').css('left', $('#add_new_img').offset().left - 2)
                    }
                }
            }
        })
        $('.step3-img').click(function () {
            $('.guide-userCenter').hide()
            $('body').css('position', 'static')
            changeStatus()
        });
        $('.jump-img').click(function () {
            $('.guide-userCenter').hide()
            $('body').css('position', 'static')
            changeStatus()
        })
        function changeStatus() {
            $.ajax({
                url: '/home/User/updateStatus',
                type: 'post',
                data: {personal_status: 1}
            })
        }


        var changeIfo = $("#changeIfo");
        var uinfo = document.getElementById("uinfo");
        var changeBox = document.getElementById("changeBox");
        changeIfo.on('click', function () {
            uinfo.style.display = "none";
            changeBox.style.display = "block";
            $("#input_company").val($("#company").html());
            $("#input_name").val($("#uname").html());
            $("#input_qq").val($("#qqid").html());
            $("#input_wechat").val($("#wechat").html());
        });
        var cancelChange = $("#cancelChange");
        cancelChange.on('click', function () {
            uinfo.style.display = "block";
            changeBox.style.display = "none";
        });

        function log(var1) {
            $('.log').append(var1 + "\r\n");
        }

        //修改密码格式检查
        var regpsw = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/;
        var flag = false;
        $('#pwd1').blur(function () {
            var val = $(this).val();
            flag = regpsw.test(val);
            if (!val) {
                $('.pwdTip').show();
                $('.pwdTip').html('*新密码不能为空');
                return false;
            }
            if (!flag) {
                $('.pwdTip').show();
                $('.pwdTip').html('*请输入长度8-20且必须包含大小写字母和数字的字符')
            } else {
                $('.pwdTip').hide();
                $('.pwdTip').html('')
            }
        })
        $('#pwd2').blur(function () {
            if (flag) {
                if ($(this).val() != $('#pwd1').val()) {
                    $('.pwdTip1').show();
                    $('.pwdTip1').html('*两次输入的密码不一致');
                } else {
                    $('.pwdTip1').hide();
                    $('.pwdTip1').html('');
                }
            }
        })

        //点击修改公司名称， 提交新工单
        $('.changeCompany').click(function () {
            $('.am-tabs-nav:first li:last').addClass('am-active');
            $('.am-tabs-nav:first li:eq(1)').removeClass('am-active');
            $('.work-order').addClass('am-active am-in');
            $('.detailInfo').removeClass('am-active am-in');
            $("#order_list").hide();
            $("#sub_work_order").show();
            $('#cancelChange').trigger('click');
        })

        //检查是否设置了密保
        $.ajax({
            url:'/home/user/isExistQuestion',
            type:'post',
            success:function(res){
                // console.log(res.status,'密保状态'); pwd-status  pwd-handel
                if(res.status==200){
                    $('.pwd-status').html('已设置');
                    $('.pwd-handel').html('修改密保');
                }else if(res.status==400){
                    $('.pwd-status').html('未设置');
                    $('.pwd-handel').html('设置密保');
                }
            }
        });

        $("#saveChange").on('click', function () {
            $.ajax({
                type: 'POST',
                url: '/home/user/updateInfo',
                data: {nickname:$("#input_name").val(),wechat:$("#input_wechat").val(),qq:$("#input_qq").val(), company: $("#input_company").val()},
                dataType: 'json',
                xhrFields: {
                    withCredentials: true
                },
                success: function (data) {
                    if (data.status == 200) {
                        alert(data.message);
                        $("#qqid").html($("#input_qq").val());
                        $("#wechat").html($("#input_wechat").val());
                        $(".nick-name").html($("#input_name").val());
                        $("#company").html($("#input_company").val());
                        uinfo.style.display = "block";
                        changeBox.style.display = "none";
                    } else {
                        alert(data.message);
                    }
                }
            });
        });

        $('#changePWD').on('click', function () {
            $('#my-cpwd').modal({
                relatedTarget: this,
                closeOnConfirm: false,
                onConfirm: function (e) {
                    var that = this
                    if (flag) {
                        var sdata = {
                            'password_now': e.data[0],
                            'password_new': e.data[1],
                            'password_new_verify': e.data[2]
                        }
                        $.ajax({
                            type: "POST",
                            url: '/home/user/updatePassword',
                            data: sdata,
                            dataType: 'json',
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function (res) {
                                $('.pwdNum').val('');
                                alert(res.message)
                                $('.pwdTip').hide();
                                $('.pwdTip').html('')
                                that.close();
                            },
                            fail: function () {
                                $('.pwdTip').hide();
                                $('.pwdTip').html('')
                            }
                        })
                    }
                },
                onCancel: function (e) {
                    $('#my-cpwd').find('input').val('')
                    $('.pwdTip').hide();
                    $('.pwdTip').html('')
                }
            });
        });

        $('#changeemail').on('click', function () {
            $('#my-cemail').modal({
                relatedTarget: this,
                onConfirm: function (e) {
                    var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
                    isok = reg.test(e.data);
                    if (!isok) {
                        alert("邮箱格式不正确，请重新输入！")
                        $('#bind-email-in').val('')
                        return;
                    } else {
                        $.ajax({
                            type: 'POST',
                            url: '/home/user/updateEmail',
                            data: {email: e.data},
                            dataType: 'json',
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function (data) {
                                if (data.status == 200) {
                                    alert(data.message);
                                    $(".saveemail").html('绑定邮箱：' + e.data);
                                    $(".changeemail").html('修改邮箱')
                                } else {
                                    alert(data.message);
                                }
                            }
                        });
                    }
                },
                onCancel: function (e) {
                    $('#my-cemail').find('input').val('')
                }
            });
        });

        $('#changephone').on('click', function () {
            $('#my-cphone').modal({
                relatedTarget: this,
                onConfirm: function (e) {
                    var data = e.data.toString().split(',')
                    $.ajax({
                        url:'/home/user/modifyMobileVerifyCode',
                        type:'post',
                        async:false,
                        data:{ mobile: data[0], code: data[1]},
                        dataType:'json',
                        xhrFields: {
                            withCredentials: true
                        },
                        success:function (res) {
                            if(res.status == 200){
                                alert('修改手机号成功')
                                $(".savemobile").html("手机绑定："+data[0]);
                                $('#my-cphone').find('input').val('')
                            }else {
                                alert(res.message)
                                $('#my-cphone').find('input').val('')
                            }
                        }
                    })
                },
                onCancel: function (e) {
                    $('#my-cphone').find('input').val('')
                }
            });
        });

        //密保问题填充
        var countSetting = 0;//点击次数,重复点击只获取一次数据
        var pwdChangeOption1 = []; //未设密保
        var pwdChangeOption = []; //已设密保

        //获取密保问题
        if (countSetting === 0) {
            countSetting++;
            $.ajax({
                url:'/home/user/indexQuestion',
                type:'post',
                async:false,
                dataType:'json',
                xhrFields: {
                    withCredentials: true
                },
                success:function(res){
                    pwdChangeOption1 = res.data.list;
                    for (var i=1;i<=pwdChangeOption1.length;i++){
                        $('.settingPwdproSelect1').append("<option value="+i+">"+pwdChangeOption1[i-1]+"</option>");
                        $('.settingPwdproSelect2').append("<option value="+i+">"+pwdChangeOption1[i-1]+"</option>");
                        $('.settingPwdproSelect3').append("<option value="+i+">"+pwdChangeOption1[i-1]+"</option>");
                    }
                },
            });
        }

        var countChange = 0;

        //获取已设密保
        function readQuestion() {
            $.ajax({
                url: '/home/user/readQuestion',
                type: 'post',
                async: false,
                success: function (res) {
                    // console.log(res);
                    for (var i in res.data) {
                        pwdChangeOption.push(res.data[i])
                    }
                    console.log(pwdChangeOption);
                    for (var i = 1; i <= pwdChangeOption.length; i++) {
                        $('.PwdproChangeSelect1').append("<option value=" + i + ">" + pwdChangeOption[i - 1] + "</option>");
                        $('.PwdproChangeSelect2').append("<option value=" + i + ">" + pwdChangeOption[i - 1] + "</option>")
                    }
                },
                fail: function () {
                    alert('未知错误')
                }
            });
        }

        $('#changepwdPro').on('click', function () {
            if ($('.pwd-handel').html() === '设置密保') {
                //设置密保
                $('#my-pwdpro').modal({
                    closeViaDimmer:0,
                    closeOnConfirm:false,
                    relatedTarget: this,
                    onConfirm: function (e) {
                        var that = this;

                        //获取用户输入信息
                        var pwdpro = [];
                        $('.chan1 select').each(function (index) {
                            var _val = $(this).val();
                            var that = this;
                            pwdpro.push(fn(index));
                            function fn(index) {
                                var qus,_id = index+1;
                                if(_val==12){
                                    qus = $(that).parents().children('input').val();
                                }else {
                                    qus = $(that).find('option:selected').text();
                                }
                                return {
                                    id:index,question:qus,answer:$(".settingPwdproSelect"+_id+"Input").val()
                                }
                            }
                        });

                        if(pwdpro[0].answer&&pwdpro[1].answer&&pwdpro[2].answer){
                            $.ajax({
                                url:'/home/user/updateQuestion',
                                type:'post',
                                data:{
                                    question_one:pwdpro[0].question,answer_one:pwdpro[0].answer,
                                    question_two:pwdpro[1].question,answer_two:pwdpro[1].answer,
                                    question_three:pwdpro[2].question,answer_three:pwdpro[2].answer,
                                },
                                dataType:'json',
                                xhrFields: {
                                    withCredentials: true
                                },
                                // async:false,
                                success: function (res) {
                                    // console.log( res,('密保设置成功'));
                                    alert('密保设置成功');
                                    $('.pwd-status').html('已设置');
                                    $('.pwd-handel').html('修改密保');
                                    that.close();
                                }
                            })
                        } else{
                            alert('请确定答案')
                        }

                    },
                    onCancel: function (e) {
                        $('.settingPwdproSelect1Input').val('');
                        $('.settingPwdproSelect2Input').val('');
                        $('.settingPwdproSelect3Input').val('');
                        $('.chan1 select').each(function () {
                            if($(this).val()==12){
                                $(this).val('0');
                                $(this).parents().children('input').hide();
                                $(this).parents().children('input').val('')
                            }else{
                                $(this).val('0');
                            }
                        });
                    }
                });
            }
            else {
                //获取已经设置的密保问题
                if (countChange == 0) {
                    countChange++;
                    readQuestion()
                }
                $('#my-pwdproChange').modal({
                    relatedTarget: this,
                    closeOnConfirm:false,
                    closeViaDimmer:0,
                    onConfirm: function (e) {
                        var that =this;
                        var que1= $('.PwdproChangeSelect1').find('option:selected').text();
                        var que2= $('.PwdproChangeSelect2').find('option:selected').text();
                        var ans1= $('.PwdproChangeSelect1Input').val();
                        var ans2= $('.PwdproChangeSelect2Input').val();

                        if(que1&&que2&&ans1&&ans2){
                            $.ajax({
                                url:'/home/user/verification',
                                type:'post',
                                data:{
                                    question_one:que1,answer_one:ans1,
                                    question_two:que2,answer_two:ans2
                                },
                                dataType:'json',
                                xhrFields: {
                                    withCredentials: true
                                },
                                async:false,
                                success: function (res) {
                                    if (res.status==200){
                                        that.close();
                                        $('.PwdproChangeSelect1').val(0);
                                        $('.PwdproChangeSelect2').val(0);
                                        $('.PwdproChangeSelect1Input').val('');
                                        $('.PwdproChangeSelect2Input').val('');
                                        //验证密保通过后跳转设置密保
                                        $('#my-pwdpro').modal({
                                            relatedTarget:this,
                                            onConfirm:function (e) {
                                                //获取用户输入信息
                                                var pwdpro = [];
                                                $('.chan1 select').each(function (index) {
                                                    var _val = $(this).val();
                                                    var that = this;
                                                    pwdpro.push(fn(index));
                                                    function fn(index) {
                                                        var qus,_id = index+1;
                                                        if(_val==12){
                                                            qus = $(that).parents().children('input').val();
                                                        }else {
                                                            qus = $(that).find('option:selected').text();
                                                        }
                                                        return {
                                                            id:index,question:qus,answer:$(".settingPwdproSelect"+_id+"Input").val()
                                                        }
                                                    }
                                                });
                                                if(pwdpro[0].answer&&pwdpro[1].answer&&pwdpro[2].answer){
                                                    $.ajax({
                                                        url:'/home/user/questionUpdate',
                                                        type:'post',
                                                        data:{
                                                            question_one:pwdpro[0].question,answer_one:pwdpro[0].answer,
                                                            question_two:pwdpro[1].question,answer_two:pwdpro[1].answer,
                                                            question_three:pwdpro[2].question,answer_three:pwdpro[2].answer
                                                        },
                                                        dataType:'json',
                                                        xhrFields: {
                                                            withCredentials: true
                                                        },
                                                        // async:false,
                                                        success: function (res) {
                                                            // console.log( res,('密保设置成功'));
                                                            alert('密保修改成功');
                                                            pwdChangeOption = [];
                                                            $('.PwdproChangeSelect1 option[value = 1]').remove()
                                                            $('.PwdproChangeSelect1 option[value = 2]').remove()
                                                            $('.PwdproChangeSelect1 option[value = 3]').remove()
                                                            $('.PwdproChangeSelect2 option[value = 1]').remove()
                                                            $('.PwdproChangeSelect2 option[value = 2]').remove()
                                                            $('.PwdproChangeSelect2 option[value = 3]').remove()
                                                            readQuestion();
                                                            that.close();
                                                            $('.chan1 select').each(function () {
                                                                if($(this).val()==4){
                                                                    $(this).val('0');
                                                                    $(this).parents().children('input').hide();
                                                                    $(this).parents().children('input').val('')
                                                                }else{
                                                                    $(this).val('0');
                                                                }
                                                            });
                                                            $('.chan1 input').each(function () {
                                                                $(this).val('')
                                                            })

                                                        }
                                                    })
                                                } else{
                                                    alert('请确定答案')
                                                }
                                            },
                                            onCancel:function () {
                                                $('.settingPwdproSelect1Input').val('');
                                                $('.settingPwdproSelect2Input').val('');
                                                $('.settingPwdproSelect3Input').val('');
                                                $('.chan1 select').each(function () {
                                                    if($(this).val()==4){
                                                        $(this).val('0');
                                                        $(this).parents().children('input').hide();
                                                        $(this).parents().children('input').val('')
                                                    }else{
                                                        $(this).val('0');
                                                    }
                                                });
                                            }
                                        })
                                    } else {
                                        alert('验证错误，请确认信息');
                                        return;
                                    }
                                },
                                fail:function (res) {
                                    alert('请重试');
                                    return;
                                }
                            })
                        } else{
                            alert('请确定答案');
                            return;
                        }
                    },
                    onCancel: function (e) {
                        // console.log(e)
                        $('.PwdproChangeSelect1').val('0');
                        $('.PwdproChangeSelect2').val('0');
                        $('.PwdproChangeSelect1Input').val('');
                        $('.PwdproChangeSelect2Input').val('');
                    }
                });
            }
        });

        $.ajax({
            type: 'POST',
            url: '/home/page/getUserCenterDetail',
            data: null,
            dataType: 'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (data.status == 1) {
                    $("#p_count").html('小程序数量：' + data.program_count);
                    $("#mobile").html(data.mobile);
                    if(data.email){
                        $(".saveemail").html("绑定邮箱："+data.email);
                        $("#changeemail").html('&nbsp;修改邮箱')
                    } else $(".saveemail").html("绑定邮箱：未绑定");
                    $(".savemobile").html("手机绑定：" + data.mobile);
                    $("#ptype").html("版本类型：" + data.edition.versions);
                    var count = 0
                    if (data.edition.versions === '旗舰版') {
                        $("#sjbtn").hide();
                        $("#xfbtn").show()
                        count = 20 - data.program_count
                    } else {
                        if(data.edition.versions === '基础版'){
                            count = 2 - data.program_count
                        }else{
                            count = 10 - data.program_count
                        }
                        $("#sjbtn").show();
                        $("#xfbtn").hide()
                    }
                    count = count > 0 ? count : 0
                    $("#p_count1").html('剩余小程序数量：' + count);
                    $("#endtimee").html("到期时间：" + data.edition.version_expire);
                    $("#qqid").html(data.qq);
                    $("#wechat").html(data.wechat);
                    $("#email").html(data.email);
                    $("#company").html(data.company);
                    for (var i = 0; i < data.program_list.length; i++) {
                        if(data.program_list[i].program_type == '6'){
                            $("#add_new").after("<li>" +
                                "<div class='li-con'><img class='am-thumbnail' src='/home/assets/i/mypr1.png' />" +
                                    "<div class='name'><h2>" + data.program_list[i].name + "</h2><p>" + data.program_list[i].create_date + "</p>" +
                                    "</div>" +
                                    "<div class='method'><span class='manage' onclick='choosecmsprogram.call(this)' data-pid='" + data.program_list[i].program_code + "'><a>管理</a></span><span class='edit'>(不可编辑模板)</span>" +
                                    "</div>" +
                                "</div></li>");
                        }else{
                            $("#add_new").after("<li>" +
                                "<div class='li-con'><img class='am-thumbnail' src='/home/assets/i/mypr1.png' />" +
                                    "<div class='name'><h2>" + data.program_list[i].name + "</h2><p>" + data.program_list[i].create_date + "</p>" +
                                    "</div>" +
                                    "<div class='method'><span class='edit' onclick='choosedesignprogram.call(this)' data-pid='" + data.program_list[i].program_code + "'><a>编辑</a></span><span class='manage' onclick='choosecmsprogram.call(this)' data-pid='" + data.program_list[i].program_code + "'><a>管理</a></span><span class='preview' onclick='previewprogram.call(this)' data-pid='" + data.program_list[i].program_code + "'><a>预览</a></span>" +
                                    "</div>" +
                                "</div></li>");
                        }
                    }
                }
                else{
                    alert(data.message);
                    if(data.message == '请登录'){
                        window.location.href = '/home/login';
                    }
                }
            }
        });
        $.ajax({
            type:"post",
            url:'/home/work_order/index',
            data:null,
            dataType:'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (res) {
                if (res.status == 200) {
                    var data = res.data.data
                    for(var i = 0;i < data.length;i++ ){
                        if(data[i].status == "已结单"){
                            $("#order_all").append("<tr> <td>"+ data[i].number +"</td> <td>"+data[i].create_time+"</td> <td>"+data[i].title+"</td> <td>"+data[i].question_type+"</td> <td>"+data[i].describe+"</td> <td>"+data[i].status+"</td> <td>  <button class='show_order_detail' onclick='toOrderDetail.call(this)' data-id=" + data[i].number + ">详情</button></td> </tr>")
                        } else{
                            $("#order_all").append("<tr> <td>"+ data[i].number +"</td> <td>"+data[i].create_time+"</td> <td>"+data[i].title+"</td> <td>"+data[i].question_type+"</td> <td>"+data[i].describe+"</td> <td>"+data[i].status+"</td> <td>  <button class='show_order_detail' onclick='toOrderDetail.call(this)' data-id=" + data[i].number + ">详情</button> <button class='orderdone' onclick='orderdone.call(this)' data-id=" + data[i].number + " data_div='order_all'>结单</button> </td> </tr>")
                        }
                    }
                }
            }
        });


    });

    function choosedesignprogram() {
        $.ajax({
            type: 'POST',
            url: '/home/program/chooseProgram',
            data: {program_code: $(this).data("pid")},
            dataType: 'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (data.status == 200) {
                    window.location.href = "/design/";
                } else{
                    alert(data.message)
                    window.location.href = data.url;
                }
            }
        });
    }

    //去管理后台
    function choosecmsprogram() {
        $.ajax({
            type: 'POST',
            url: '/home/page/chooseProgram',
            data: {program_code: $(this).data("pid")},
            dataType: 'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (data.status == 1) {
                    toBackEnd();
                } else if (data.status == -1)  {
                    alert(data.message)
                    window.location.href = data.url;
                }
            }
        });
    }
    function previewprogram() {
        $.ajax({
            type: 'POST',
            url: '/home/program/chooseProgram',
            data: {program_code: $(this).data("pid")},
            dataType: 'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (data.status == 200) {
                    window.location.href = "/design/preview/index.html";
                } else {
                    window.location.href = data.url;
                }
            }
        });
    }

    //去后台验证是否已经生成小程序
    function toBackEnd() {
        $.ajax({
            type: 'POST',
            url: '/home/page/toBackend',
            dataType: 'json',
            xhrFields: {
                withCredentials: true
            },
            success: function (response) {
                if(response.status === 0){
                    alert(response.message);
                    return;
                }else{
                    window.location.href = "/cms/";
                }
            }
        });
    }

    $('.show-protocol').click(function () {
            $('#my-cprogram').modal({
                relatedTarget: this,
                 closeOnConfirm: false,
                onConfirm: function (e) {
                    console.log(e.data);
                    let dol = /[.]/g;
                    if(dol.test(e.data)){
                        alert("小程序名称不能出现'.'!")
                    }else if(e.data.match(/^[ ]*$/)){
                        alert("小程序名称不能为空!")
                    }else{
                        $('#my-cprogram').modal('close');
                        $('.mpName').val('');
                        $.ajax({
                            type: 'POST',
                            url: '/home/page/createProgram',
                            data: {program_name: e.data},
                            dataType: 'json',
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function (data) {
                                if (data.status == 1) {
                                    $("#add_new").after("<li><div class='li-con'><img class='am-thumbnail' src='/home/assets/i/mypr1.png' /><div class='name'><h2>" + e.data + "</h2><p>" + data.create_date + "</p></div><div class='method'><span class='edit' onclick='choosedesignprogram.call(this)' data-pid='" + data.program_code + "'><a>编辑</a></span><span class='manage' onclick='choosecmsprogram.call(this)' data-pid='" + data.program_code + "'><a>管理</a></span></div></div></li>");
                                } else {
                                    alert(data.message);
                                }
                            }
                        });
                    }
                },
                onCancel: function (e) {
                    $('.mpName').val('')
                }
            });
    });

    $(function() {
		$('.up-pay').click(function () {
        window.location.href="/home/payment.html"
    })
    });

    //隐藏已选择问题
    $(function () {
        var oldvar = '';
        $(".chan1 select").change(function(){
            oldvar = $(this).attr('old');
            var thisVal = $(this).val();
            var that = this;
            if(thisVal==12){
                $(this).parent().find('input').show();
                $('.chan1 select').not(this).find("option[value="+oldvar+"]").show();
            }else{
                $(this).parent().find('input').hide();
                $('.chan1 select').not(that).each(function () {
                    $(this).find('option').each(function () {
                        if($(this).val()==thisVal){
                            $(this).hide();
                            $('.chan1 select').not(this).find("option[value="+oldvar+"]").show();
                            $(that).attr('old',thisVal)
                        }
                    })
                })
            }
        })
    });

    $(function () {
        var oldvar = '';
        $(".chan2 select").change(function(){
            oldvar = $(this).attr('old');
            var thisVal = $(this).val();
            var that = this;
            $('.chan2 select').not(this).find('option').each(function () {
                    if($(this).val()==thisVal){
                        $(this).hide();
                        $('.chan2 select').not(this).find("option[value="+oldvar+"]").show();
                        $(that).attr('old',thisVal)
                    }
            })
        })
    })


</script>
<script src="/home/assets/js/usercenter.js"></script>
<script src="/home/assets/js/userCenterSonAccount.js"></script>

</body>
</html>
